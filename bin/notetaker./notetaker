#!/bin/bash

NOTES_DIR="$HOME/Documents/Notes"
mkdir -p "$NOTES_DIR"

# Get note from rofi
note=$(echo "" | rofi -dmenu -p "" -lines 0 -no-fixed-num-lines -width 50 -theme ~/.config/rofi/themes/minimal.rasi)


if [ -n "$note" ]; then
    # Timestamp for inside the file
    timestamp=$(date '+%d-%m-%Y %H:%M:%S')

    # Create a safe filename version of the note
    safe_title=$(echo "$note" | tr ' ' '_' | tr -dc 'A-Za-z0-9_-')

    # Fallback if title is empty after sanitization
    if [ -z "$safe_title" ]; then
        safe_title="note"
    fi

    # Final path
    filepath="$NOTES_DIR/${safe_title}.txt"

    # Add timestamp inside file, then the note itself
    {
        echo "$note"
        echo
        echo "Created: $timestamp"
    } > "$filepath"

    # Show notification
    notify-send "Note Saved" "$(basename "$filepath")"
fi

